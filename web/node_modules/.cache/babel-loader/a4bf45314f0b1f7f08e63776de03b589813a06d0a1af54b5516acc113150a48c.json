{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PC\\\\Downloads\\\\IT342\\\\IT342_G5_Hopista_Lab1\\\\web\\\\src\\\\components\\\\Navbar.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport api, { clearTokens } from \"../config/axios\";\n\n// Helper to decode JWT and read username from `sub`\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst decodeJwt = token => {\n  try {\n    const base64Url = token.split(\".\")[1];\n    const base64 = base64Url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    const jsonPayload = decodeURIComponent(atob(base64).split(\"\").map(c => \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2)).join(\"\"));\n    return JSON.parse(jsonPayload);\n  } catch (e) {\n    return null;\n  }\n};\nconst Navbar = () => {\n  _s();\n  const navigate = useNavigate();\n  const [isAuthed, setIsAuthed] = useState(false);\n  const [username, setUsername] = useState(\"\");\n  const updateAuthState = () => {\n    const accessToken = localStorage.getItem(\"accessToken\");\n    const authed = Boolean(accessToken);\n    setIsAuthed(authed);\n    if (authed) {\n      const payload = decodeJwt(accessToken);\n      const name = (payload === null || payload === void 0 ? void 0 : payload.sub) || \"\";\n      setUsername(name);\n    } else {\n      setUsername(\"\");\n    }\n  };\n  useEffect(() => {\n    updateAuthState();\n    const onStorage = e => {\n      if (e.key === \"accessToken\" || e.key === \"refreshToken\") {\n        updateAuthState();\n      }\n    };\n    window.addEventListener(\"storage\", onStorage);\n    return () => window.removeEventListener(\"storage\", onStorage);\n  }, []);\n  const handleLogout = async () => {\n    try {\n      const refreshToken = localStorage.getItem(\"refreshToken\");\n      if (refreshToken) {\n        await api.post(\"/auth/logout\", {\n          refreshToken\n        });\n      }\n    } catch (err) {\n      console.error(\"Logout error\", err);\n    } finally {\n      clearTokens();\n      updateAuthState();\n      navigate(\"/login\", {\n        replace: true\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"nav\", {\n    style: {\n      padding: \"10px 16px\",\n      borderBottom: \"1px solid #eee\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        alignItems: \"center\",\n        gap: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: \"/\",\n        style: {\n          fontWeight: 600\n        },\n        children: \"Hopista\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginLeft: \"auto\",\n          display: \"flex\",\n          gap: 12\n        },\n        children: !isAuthed ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Link, {\n            to: \"/login\",\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/register\",\n            children: \"Register\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              opacity: 0.8\n            },\n            children: [\"Hello\", username ? `, ${username}` : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/profile\",\n            children: \"Profile\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleLogout,\n            children: \"Logout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 9\n  }, this);\n};\n_s(Navbar, \"5CWjSGh0SCFnFfrRvthPtjWjcE8=\", false, function () {\n  return [useNavigate];\n});\n_c = Navbar;\nexport default Navbar;\nvar _c;\n$RefreshReg$(_c, \"Navbar\");","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","api","clearTokens","jsxDEV","_jsxDEV","Fragment","_Fragment","decodeJwt","token","base64Url","split","base64","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","e","Navbar","_s","navigate","isAuthed","setIsAuthed","username","setUsername","updateAuthState","accessToken","localStorage","getItem","authed","Boolean","payload","name","sub","onStorage","key","window","addEventListener","removeEventListener","handleLogout","refreshToken","post","err","console","error","style","padding","borderBottom","children","display","alignItems","gap","to","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","marginLeft","opacity","onClick","_c","$RefreshReg$"],"sources":["C:/Users/PC/Downloads/IT342/IT342_G5_Hopista_Lab1/web/src/components/Navbar.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport api, { clearTokens } from \"../config/axios\";\r\n\r\n// Helper to decode JWT and read username from `sub`\r\nconst decodeJwt = (token) => {\r\n    try {\r\n        const base64Url = token.split(\".\")[1];\r\n        const base64 = base64Url.replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n        const jsonPayload = decodeURIComponent(\r\n            atob(base64)\r\n                .split(\"\")\r\n                .map((c) => \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2))\r\n                .join(\"\")\r\n        );\r\n        return JSON.parse(jsonPayload);\r\n    } catch (e) {\r\n        return null;\r\n    }\r\n};\r\n\r\nconst Navbar = () => {\r\n    const navigate = useNavigate();\r\n    const [isAuthed, setIsAuthed] = useState(false);\r\n    const [username, setUsername] = useState(\"\");\r\n\r\n    const updateAuthState = () => {\r\n        const accessToken = localStorage.getItem(\"accessToken\");\r\n        const authed = Boolean(accessToken);\r\n        setIsAuthed(authed);\r\n        if (authed) {\r\n            const payload = decodeJwt(accessToken);\r\n            const name = payload?.sub || \"\";\r\n            setUsername(name);\r\n        } else {\r\n            setUsername(\"\");\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        updateAuthState();\r\n        const onStorage = (e) => {\r\n            if (e.key === \"accessToken\" || e.key === \"refreshToken\") {\r\n                updateAuthState();\r\n            }\r\n        };\r\n        window.addEventListener(\"storage\", onStorage);\r\n        return () => window.removeEventListener(\"storage\", onStorage);\r\n    }, []);\r\n\r\n    const handleLogout = async () => {\r\n        try {\r\n            const refreshToken = localStorage.getItem(\"refreshToken\");\r\n            if (refreshToken) {\r\n                await api.post(\"/auth/logout\", { refreshToken });\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Logout error\", err);\r\n        } finally {\r\n            clearTokens();\r\n            updateAuthState();\r\n            navigate(\"/login\", { replace: true });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <nav style={{ padding: \"10px 16px\", borderBottom: \"1px solid #eee\" }}>\r\n            <div style={{ display: \"flex\", alignItems: \"center\", gap: 16 }}>\r\n                <Link to=\"/\" style={{ fontWeight: 600 }}>Hopista</Link>\r\n\r\n                <div style={{ marginLeft: \"auto\", display: \"flex\", gap: 12 }}>\r\n                    {!isAuthed ? (\r\n                        <>\r\n                            <Link to=\"/login\">Login</Link>\r\n                            <Link to=\"/register\">Register</Link>\r\n                        </>\r\n                    ) : (\r\n                        <>\r\n                            <span style={{ opacity: 0.8 }}>Hello{username ? `, ${username}` : \"\"}</span>\r\n                            <Link to=\"/profile\">Profile</Link>\r\n                            <button onClick={handleLogout}>Logout</button>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </nav>\r\n    );\r\n};\r\n\r\nexport default Navbar;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}